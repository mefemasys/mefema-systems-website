# ------------------------------
# Configurações de Servidor
# ------------------------------
Options -MultiViews -Indexes
RewriteEngine On
RewriteBase /

# Impede que o Apache force a barra / em pastas físicas
DirectorySlash Off

# 1. Remover "index.php" da URL (Redirecionamento Limpo)
RewriteCond %{THE_REQUEST} \s/+index\.php[\s?]
RewriteRule ^index\.php$ / [L,R=301]

# 2. Remover barra final de qualquer URL (Ex: /produtos/ -> /produtos)
# Isso evita duplicidade de conteúdo e conflitos com pastas
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} (.+)/$
RewriteRule ^ %1 [L,R=301]

# 3. REGRA MÁGICA: Mapear qualquer URL para arquivo .php correspondente
# Funciona para /produtos, /produtos/websites, /empresa/historia, etc.
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.+)$ $1.php [L,QSA]

# 4. Redirecionar raiz para index.php (interno)
RewriteRule ^$ index.php [L]

# ------------------------------
# Proteção de arquivos
# ------------------------------
<FilesMatch "\.(env|ini|log|md|sql)$">
    Require all denied
</FilesMatch>

<Files .htaccess>
    Require all denied
</Files>


# ------------------------------
# Páginas de Erro Personalizadas
# ------------------------------

# 404 - Não Encontrado (URL incorreta)
ErrorDocument 404 /pages/error/not-found.php

# 403 - Acesso Negado (Permissão insuficiente)
ErrorDocument 403 /pages/error/unauthorized.php
ErrorDocument 401 /pages/error/unauthorized.php

# 500 - Erro Interno do Servidor
ErrorDocument 500 /pages/error/internal-server-error.php
